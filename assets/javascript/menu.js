var YOUR_APP_ID = '060d6c07';
var YOUR_APP_KEY = '4caf8f45e89f735e57b03965c8dc01b8';
var ingredientsArray= []; //this is to set an empty array that we will push ingredients into
var ingredientsCaloriesArray = []; // this is an empty array where we will push the num of total calories of each ingredient added.


$('#search-button').on('click', function () {
  var food = $("#food-name").val();
  var quantity = $("#quantity").val();
  var size = $("#size").val();
  var searchString = quantity + " " + size + " " + food;
  //First AJAX call for food nutritional info
  $.ajax({
    url: `https://api.edamam.com/api/nutrition-data?app_id=${YOUR_APP_ID}&app_key=${YOUR_APP_KEY}&ingr=${searchString}`,
    method: "GET"
  }).then(function (response) {
    console.log(response);
    $('#food').text(food);
    $('#calories').text(Math.round(response.calories));
    $('#carbs').text(response.totalNutrients.CHOCDF.quantity);
    $('#protein').text(response.totalNutrients.PROCNT.quantity);
    $('#fat').text(response.totalNutrients.FAT.quantity);
  });

});
//created an add ingredient button to the page and added variable food and calories
$('#add-ingredient').on('click', function () {
  var food = $('#food').text();
  var calories = parseInt($('#calories').text()); //this is to get the calories in a number to be able to add it up 
  ingredientsCaloriesArray.push(calories) //this adds the calories to the empty array
  
  // this added both the food name and calories generated by the first search into the add ingredient table

  $("#ingredients").append("<tr><td> " + food + "</td><td> " + Math.round(calories) + "</td></tr>");
  ingredientsArray.push(food); //This adds the ingredients put in to the ingredients array
  var total=0;
  for(var i in ingredientsCaloriesArray) { total += ingredientsCaloriesArray[i]; } //summing up ingredient calories in ingredients calories array

  $('#total-ingredients-calories').text(total); //updating calories to total calories using  the total variable
});
//created a button called "add-to-table" and did an on click event to capture the food name put in by users

$('#find-recipes').on('click', function () {
  var recipeSearch = ingredientsArray.toString(); //added the results of search recipe to the empty array and then converted the array to a string to combine the ingredients and generate a recipe based on ingredients
  //Second AJAX call for recipes data
  $.ajax({
    url: `https://api.edamam.com/search?q=${recipeSearch}&app_id=65b4957f&app_key=2307311a6f68d1a304d10e8552b128ed&to=5`, //the "to=5" limits the number of recipes shown on the page to 5
    method: "GET"
  }).then(function (response) {
    console.log(response.hits);
    //Did a for loop so response can loop through the hits in the array i.e recipes
    for (i = 0; i < response.hits.length; i++) {

      //setting the url to a link tag to make the food name/label clickable
      $('#recipes-table').append(
        `<tr>
          <td><a href="${response.hits[i].recipe.url}">${response.hits[i].recipe.label}</a></td>
          <td><img src="${response.hits[i].recipe.image}"/></td>
          <td>${Math.round(response.hits[i].recipe.calories)}</td>
        </tr>`
      ); //This is a backtick string representing the html for a row and the cells inside the recipe table. Used html link, image and text.

      //$('#recipes-table').append(response.hits[i].recipe.label);  
      // this was initially adding the label name on the page but I made the label name clicakble by adding a link to it so it's no longer neccessary      


      

      //Math.round rounds up ( the calories) numbers
      //added text "total calories" to show on page next the calorie amount/number





    }

  });
});